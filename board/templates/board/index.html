{% load staticfiles %}
{% load board_extras %}
<!DOCTYPE html>
<html>

	<head>
		<title>Tox Feedback Board</title>
		<link rel="stylesheet" type="text/css" href="{% static 'board/style.css' %}" />
	</head>

	<body>
		<h1>Tox Feedback Board</h1>

		<h3>Create Thread</h3>

		<form action="{% url 'create_thread' %}" method="post">
			{% csrf_token %}
			<table>
				<input type="hidden" name="a" value="{{ a }}">
				<input type="hidden" name="b" value="{{ b }}">
				<tr>
					<td>Title</td>
					<td style="background:none;"><input type="text" name="title" size="20"></td>	
				</tr>
				<tr>
					<td>{{ a }} + {{ b }} = ?</td>
					<td style="background:none;"><input type="text" name="captcha" size"20"><input type="submit" value="Create Thread"></td>
				</tr>
				<tr>
					<td>Message</td>
					<td style="background:none;"><textarea rows="5" cols="36" name="text"></textarea></td>
				</tr>
				<tr>
					<td style="background:none;"></td>
					<td style="background:none;"><i style="font-size:11px;color:black">Messages must be between 5 and 2000 characters</i></td>
				</tr>
			</table>	
		</form>

		<hr>

{% if threads %}
	{% for thread in threads %}	
		<div class="post">	
			<b style="color:#078400">{{ thread.thread_title }}</b> {{ thread.pub_date }} No.{{ thread.id }} <a href="{% url 'thread' thread.id %}">[View Thread]</a>
			<div class="post text">
				{{ thread.thread_text|post_urlize }}
			</div>
			<br>		
			{% if thread.thread_count > 5 %}
			<i style="font-size:11px;padding-left:16px">Total Replies: {{ thread.thread_count }}</i><br>
			{% endif %}
		
			{% for objects in replies %}	
				{% if forloop.counter == forloop.parentloop.counter %}	
					{% for reply in objects reversed %}		
						<div class="post reply">	
							{{ reply.pub_date }} <a href="/thread/{{ thread.id }}/#{{ reply.id }}">No.{{ reply.id }}</a>
							<div class="post reply body">
								{{ reply.post_text|post_urlize }}
							</div>
						</div>
						<br>
					{% endfor %}
				{% endif %}
			{% endfor %} 		
		</div>
		<hr>
	{% endfor %}
{% else %}
	<p>No threads</p>
{% endif %}

	<br>
	Pages: <a href="/">[ 0 ]</a> 
	{% for i in pagecount|get_range %}
		<a href="/{{ forloop.counter }}/">[ {{ forloop.counter }} ]</a> 
	{% endfor %}
	<br><br> 
	<i style="font-size:11px;">Total threads: {{ threadcount }}</i>
	<br><br>
	
	<hr>

	<div class="footer">
	Developed by <a href="https://Github.com/Astonex">Mark Winter</a> (astonex). Licensed under AGPLv3
	</div>
	
	</body>
</html>
